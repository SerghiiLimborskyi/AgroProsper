name: ğŸ“œ Update CHANGELOG.md

on:
  push:
    tags:
      - 'v*'

permissions:
  contents: write

jobs:
  changelog:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: ğŸ” ĞĞ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ CHANGELOG.md
        run: |
          VERSION=${GITHUB_REF#refs/tags/}
          DATE=$(date +'%Y-%m-%d')
          sed -i "/## 

\[Unreleased\]

/a\\
\\
## [$VERSION] â€“ $DATE" CHANGELOG.md
          sed -i "/## 

\[$VERSION\]

/,/^---/!b;//!d" CHANGELOG.md

      - name: ğŸ’¾ ĞšĞ¾Ğ¼Ñ–Ñ‚ Ğ·Ğ¼Ñ–Ğ½
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "ğŸ“œ ĞĞ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾ CHANGELOG.md Ğ´Ğ»Ñ ${{ github.ref_name }}"
