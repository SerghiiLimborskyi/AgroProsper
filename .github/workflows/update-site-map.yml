name: Update site-map.json and sitemap.xml

on:
  push:
    branches:
      - main

jobs:
  generate-site-map:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
        uses: actions/checkout@v3

      - name: –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: –ó–∞–ø—É—Å–∫ generate-site-map.py
        run: python generate-site-map.py

      - name: –ó–∞–ø—É—Å–∫ generate-sitemap-xml.py
        run: python generate-sitemap-xml.py

      - name: –ö–æ–º—ñ—Ç –æ–±–æ—Ö —Ñ–∞–π–ª—ñ–≤
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add site-map.json sitemap.xml
          git commit -m "üîÑ –ê–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω–Ω—è site-map —ñ sitemap.xml"
          git push
        continue-on-error: true


- name: –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ Node.js
  uses: actions/setup-node@v3
  with:
    node-version: '18'
    
 - name: üó∫Ô∏è Generate sitemap
  run: node docs/scripts/generate-sitemap.js
