<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard — AgroProsper DAO</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="styles/theme-agro.css" />
  <script src="scripts/themeSwitcher.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<!-- 🎨 Перемикач теми -->
<section id="interfaceControls">
  <label>🎨 Тема:
    <select onchange="setTheme(this.value)">
      <option value="agrosoul">AgroSoul</option>
      <option value="ethicbloom">EthicBloom</option>
      <option value="livingdao">LivingDAO</option>
    </select>
  </label>
</section>

<!-- 🧠 Статус гравця -->
<header>
  <h1>🛠️ Панель адміністратора DAO</h1>
  <p>CID: <strong id="adminCID">Завантаження...</strong></p>
  <p>Титул: <strong id="adminTitle">Завантаження...</strong></p>
  <p>Зелені кредити: <strong id="adminCredits">0</strong></p>
</header>

<!-- 📊 DAO-графіки -->
<section>
  <h2>📊 DAO-графіки</h2>
  <canvas id="tokenChart" width="400" height="200"></canvas>
  <canvas id="questChart" width="400" height="200"></canvas>
</section>

<!-- 💰 AGT-токени -->
<section>
  <h2>💰 AGT-токени</h2>
  <p>Баланс DAO: <strong id="agtBalance">AGT: 1000</strong></p>
  <button onclick="simulateTransfer()">🔄 Симулювати переказ</button>
</section>

<!-- ⚖️ Моральний баланс -->
<section>
  <h2>⚖️ Моральний баланс DAO</h2>
  <canvas id="moralChart" width="400" height="200"></canvas>
</section>

<!-- 🌍 Стан планети -->
<section>
  <h2>🌍 Стан планети</h2>
  <p>🧪 CO₂: <span id="co2">412 ppm</span></p>
  <p>☢️ Радіація: <span id="radiation">0.12 µSv/h</span></p>
  <p>🔆 Сонячний потік: <span id="solar">5.6 W/m²</span></p>
  <p>📊 Індикатор: <strong id="planetStatus">🟢 Зелений — стабільно</strong></p>
</section>

<!-- 🏅 Бейджі -->
<section>
  <h2>🏅 Бейджі гравця</h2>
  <ul id="badgeList"></ul>
</section>

<!-- 📜 Логи дій -->
<section>
  <h2>📜 Логи дій</h2>
  <div id="adminLogTable">Завантаження логів...</div>
</section>

<!-- 🔧 Дії адміністратора -->
<section>
  <h2>🔧 Дії адміністратора</h2>
  <button onclick="updateCID('Farmer')">🔄 Оновити CID до Farmer</button>
  <button onclick="mintBadgeSelf(1)">🏅 Видати бейдж Farmer</button>
  <button onclick="openAgentMonitor()">📊 Моніторинг агентів</button>
</section>

<!-- 🧭 DAO-навігація -->
<section>
  <h2>🧭 DAO-навігація</h2>
  <button onclick="window.location.href='start.html'">🌱 Портал</button>
  <button onclick="window.location.href='legacyArchive.html'">📜 Архів</button>
  <button onclick="window.location.href='ecoMap.html'">🗺️ Еко-мапа</button>
  <button onclick="window.location.href='daoManifesto.html'">📖 Маніфест</button>
</section>

<!-- 🧠 DAO-логіка -->
<script>
  // CID, титул, кредити
  document.getElementById("adminCID").textContent = localStorage.getItem("userCID") || "0xAGRO-XX";
  document.getElementById("adminTitle").textContent = localStorage.getItem("legacyTitle") || "Гравець";
  document.getElementById("adminCredits").textContent = localStorage.getItem("ecoCredits") || "0";

  // DAO-графік токенів
  new Chart(document.getElementById("tokenChart"), {
    type: "doughnut",
    data: {
      labels: ["Фермери", "Партнери", "Адміністратори"],
      datasets: [{ data: [120, 80, 20], backgroundColor: ["#00ff99", "#ffcc00", "#ff3366"] }]
    }
  });

  // DAO-графік квестів
  new Chart(document.getElementById("questChart"), {
    type: "bar",
    data: {
      labels: ["Солодкий вибір", "Печера Коріння", "Павутина добра"],
      datasets: [{ label: "Виконано", data: [42, 35, 27], backgroundColor: "#4caf50" }]
    }
  });

  // Моральний баланс
  const moralData = {
    labels: ["Зберігач Землі", "Етичний Архітектор", "DAO-Новачок"],
    datasets: [{ label: "Кількість гравців", data: [12, 18, 6], backgroundColor: ["#8bc34a", "#4caf50", "#ccc"] }]
  };
  new Chart(document.getElementById("moralChart"), {
    type: "bar",
    data: moralData,
    options: {
      responsive: true,
      plugins: {
        legend: { display: false },
        title: { display: true, text: "Розподіл моральних титулів серед гравців" }
      }
    }
  });

  // Симуляція переказу
  function simulateTransfer() {
    alert("💸 Переказ 50 AGT успішно симульовано!");
  }

  // CID-оновлення
  function updateCID(newRole) {
    localStorage.setItem("agentLevel", newRole);
    alert(`CID оновлено до: ${newRole}`);
  }

  // Бейджі
  const badges = JSON.parse(localStorage.getItem("badgeLog") || "[]");
  const badgeList = document.getElementById("badgeList");
  badgeList.innerHTML = badges.length
    ? badges.map(b => `<li><img src="public/badges/${b}.png" alt="${b}" style="width:60px;" /> ${b}</li>`).join("")
    : "<li>Немає бейджів</li>";

  // Логи
  const logs = JSON.parse(localStorage.getItem("directorLog") || "[]");
  const table = document.getElementById("adminLogTable");
  table.innerHTML = logs.length
    ? logs.map(log => `<p>🧾 ${log}</p>`).join("")
    : "<p>Немає записів</p>";
</script>

</body>
</html>
