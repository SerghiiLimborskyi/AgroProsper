<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>üèÖ –ì–∞–ª–µ—Ä–µ—è –±–µ–π–¥–∂—ñ–≤ ‚Äî AgroProsper DAO</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="main.css" />
</head>
<body>
  <!-- üîß –ú–µ–Ω—é -->
  <div id="menuContainer"></div>

  <header>
    <h1 id="pageTitle">üèÖ –ì–∞–ª–µ—Ä–µ—è DAO-–±–µ–π–¥–∂—ñ–≤</h1>
    <p>CID: <strong id="cidDisplay">0xAGRO-XXXX</strong></p>
    <p class="role-label" id="roleLabel">–í–∞—à–∞ —Ä–æ–ª—å: –ì—ñ—Å—Ç—å</p>
    <p id="badgeStats">–ë–µ–π–¥–∂—ñ–≤: 0 ¬∑ –†—ñ–≤–µ–Ω—å: Starter</p>
  </header>

  <!-- üß† –§—ñ–ª—å—Ç—Ä–∏ -->
  <section>
    <div class="filter-buttons">
      <button onclick="filterBadges('all')">–í—Å—ñ</button>
      <button onclick="filterBadges('guest')">–ì–æ—Å—Ç—ñ</button>
      <button onclick="filterBadges('agent')">–ê–≥–µ–Ω—Ç–∏</button>
      <button onclick="filterBadges('partner')">–ü–∞—Ä—Ç–Ω–µ—Ä–∏</button>
    </div>
  </section>

  <!-- üèÖ –ì–∞–ª–µ—Ä–µ—è -->
  <section class="badge-grid" id="badgeGallery"></section>

  <!-- üîß –§—É—Ç–µ—Ä -->
  <div id="footerContainer"></div>

  <script>
    // üåê –ú—É–ª—å—Ç–∏–º–æ–≤–Ω—ñ—Å—Ç—å
    const lang = navigator.language.startsWith("pl") ? "pl" :
                 navigator.language.startsWith("en") ? "en" : "uk";
    const t = {
      uk: { title: "üèÖ –ì–∞–ª–µ—Ä–µ—è DAO-–±–µ–π–¥–∂—ñ–≤", role: "–í–∞—à–∞ —Ä–æ–ª—å", stats: "–ë–µ–π–¥–∂—ñ–≤", level: "–†—ñ–≤–µ–Ω—å" },
      pl: { title: "üèÖ Galeria odznak DAO", role: "Twoja rola", stats: "Odznak", level: "Poziom" },
      en: { title: "üèÖ DAO Badge Gallery", role: "Your role", stats: "Badges", level: "Level" }
    };
    const tr = t[lang];
    document.title = tr.title;
    document.getElementById("pageTitle").textContent = tr.title;

    // üß† CID-–ª–æ–≥—ñ–∫–∞
    const cid = localStorage.getItem("cid") || "0xAGRO-GUEST";
    document.getElementById("cidDisplay").textContent = cid;

    let roleClass = "guest", roleName = "–ì—ñ—Å—Ç—å";
    if (cid.includes("AG")) { roleClass = "agent"; roleName = lang === "pl" ? "Agent" : lang === "en" ? "Agent" : "–ê–≥–µ–Ω—Ç"; }
    else if (cid.includes("PA")) { roleClass = "partner"; roleName = lang === "pl" ? "Partner" : lang === "en" ? "Partner" : "–ü–∞—Ä—Ç–Ω–µ—Ä"; }
    else if (cid.includes("AN")) { roleClass = "analyst"; roleName = lang === "pl" ? "Analityk" : lang === "en" ? "Analyst" : "–ê–Ω–∞–ª—ñ—Ç–∏–∫"; }

    document.body.classList.add(roleClass);
    document.getElementById("roleLabel").textContent = `${tr.role}: ${roleName}`;

    // üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    const achievements = JSON.parse(localStorage.getItem("achievements") || "[]");
    const level = localStorage.getItem("agentLevel") || "Starter";
    document.getElementById("badgeStats").textContent = `${tr.stats}: ${achievements.length} ¬∑ ${tr.level}: ${level}`;

    // üèÖ –ì–∞–ª–µ—Ä–µ—è –±–µ–π–¥–∂—ñ–≤
    const badgeGallery = document.getElementById("badgeGallery");
    achievements.forEach(badge => {
      const card = document.createElement("div");
      card.className = "badge-card";
      card.setAttribute("data-role", badge.role || "guest");
      card.innerHTML = `
        <img src="${badge.img}" alt="${badge.title}" />
        <h3>${badge.title}</h3>
        <p>${badge.desc}</p>
        ${badge.cid ? `<small>üîó <a href="https://ipfs.io/ipfs/${badge.cid}" target="_blank">IPFS</a></small>` : ""}
      `;
      badgeGallery.appendChild(card);
    });

    // üîç –§—ñ–ª—å—Ç—Ä
    function filterBadges(role) {
      const cards = document.querySelectorAll(".badge-card");
      cards.forEach(card => {
        card.style.display = (role === "all" || card.dataset.role === role) ? "block" : "none";
      });
    }

    // üì¶ –í—Å—Ç–∞–≤–∫–∞ –º–µ–Ω—é —ñ —Ñ—É—Ç–µ—Ä–∞
    fetch("menu.html")
      .then(res => res.text())
      .then(html => document.getElementById("menuContainer").innerHTML = html);

    fetch("footer.html")
      .then(res => res.text())
      .then(html => document.getElementById("footerContainer").innerHTML = html);
  </script>

  <!-- üîÑ –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è -->
  <script src="scripts/badgeSync.js" defer></script>
</body>
</html>
