<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AgroProsper Admin Panel</title>
  <link rel="stylesheet" href="style.css" />

  <!-- –°–∫—Ä–∏–ø—Ç–∏ —Å—Ç—É–¥—ñ–π -->
  <script src="studio/introStudio.js" defer></script>
  <script src="studio/problemStudio.js" defer></script>
  <script src="studio/solutionStudio.js" defer></script>
  <script src="studio/featuresStudio.js" defer></script>
  <script src="studio/questStudio.js" defer></script>
  <script src="studio/ctaStudio.js" defer></script>

  <!-- DAO-–±–æ—Ç–∏ -->
  <script src="public/directorBot.js" defer></script>
  <script src="public/cloudSync.js" defer></script>

  <!-- CID-–∫–æ–Ω—Ç—Ä–æ–ª—å -->
  <script>
    window.addEventListener("load", () => {
      const cid = localStorage.getItem("cid");
      if (!cid || cid !== "0xAGRO-7F3A") {
        alert("‚õî –î–æ—Å—Ç—É–ø –ª–∏—à–µ –¥–ª—è –ë—ñ–∑–Ω–µ—Å-–ü–∞—Ä—Ç–Ω–µ—Ä–∞ DAO.");
        document.body.innerHTML = "<h1>üîê –î–æ—Å—Ç—É–ø –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ</h1>";
      } else {
        console.log("‚úÖ CID –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ:", cid);
        cloudSync.syncAll();
      }
    });
  </script>

  <!-- –ù—ñ—á–Ω–∏–π —Ä–µ–∂–∏–º -->
  <style>
    body.night {
      background-image: url('admin-bg.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      color: #fff;
    }
    .dashboard button {
      border: none;
      padding: 10px 20px;
      margin: 10px;
      background-color: #111;
      color: #0ff;
      font-weight: bold;
      box-shadow: 0 0 10px #0ff;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    .dashboard button:hover {
      transform: scale(1.05);
    }
    #syncLog {
      background: #111;
      color: #0f0;
      padding: 10px;
      margin: 20px;
      font-family: monospace;
    }
  </style>
</head>

<body>
  <header>
    <h1>üåø AgroProsper DAO ‚Äî –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å</h1>
  </header>

  <section class="dashboard">
    <button onclick="runFullCycle()">üîÑ –ü–æ–≤–Ω–∏–π —Ü–∏–∫–ª</button>
    <button onclick="openStats()">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
    <button onclick="openVideoManager()">üé• –í—ñ–¥–µ–æ-–∫–æ–Ω—Ç–µ–Ω—Ç</button>
    <button onclick="openPartnerForm()">ü§ù –ü–∞—Ä—Ç–Ω–µ—Ä–∏</button>
    <button onclick="sendTelegramCommand()">üì® –ö–æ–º–∞–Ω–¥–∞ –±–æ—Ç—É</button>
    <button onclick="generateReport()">üìÅ –ó–≤—ñ—Ç –¥–æ –ø–æ–¥–∞—Ç–∫–æ–≤–æ—ó</button>
    <button onclick="cloudSync.syncAll()">‚òÅÔ∏è –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É–≤–∞—Ç–∏ DAO-—Ñ–∞–π–ª–∏</button>
    <button onclick="directorBot.runScenario()">üéÆ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å—Ü–µ–Ω–∞—Ä—ñ–π –≥—Ä–∏</button>
    <button onclick="directorBot.suggestCleanup()">üßπ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–∞–º‚Äô—è—Ç—å</button>
    <div id="botLog" style="background:#222; color:#0ff; padding:10px; margin-top:20px; font-family:monospace;">
  üìã –õ–æ–≥ –¥—ñ–π –±–æ—Ç–∞-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∞:
   const cidStats = {
  data: {
    guests: 0,
    agents: 0,
    partners: 0,
    total: 0
  },

  scanCID: function () {
    const cid = localStorage.getItem("cid");
    if (!cid) return;

    this.data.total++;
    if (cid.startsWith("0xGUEST")) this.data.guests++;
    else if (cid.startsWith("0xAGRO")) this.data.agents++;
    else if (cid.startsWith("0xPARTNER")) this.data.partners++;

    this.displayStats();
  },

  displayStats: function () {
    const statsBox = document.getElementById("cidStats");
    if (!statsBox) return;
    statsBox.innerHTML = `
      <h3>üìä CID-–∞–Ω–∞–ª—ñ—Ç–∏–∫–∞</h3>
      <p>–ì–æ—Å—Ç–µ–π: ${this.data.guests}</p>
      <p>–ê–≥–µ–Ω—Ç—ñ–≤: ${this.data.agents}</p>
      <p>–ü–∞—Ä—Ç–Ω–µ—Ä—ñ–≤: ${this.data.partners}</p>
      <p>–í—Å—å–æ–≥–æ: ${this.data.total}</p>
    `;
  }
};

window.addEventListener("load", () => {
  cidStats.scanCID();
});   
</div>

  </section>

  <section id="output"></section>
  <div id="syncLog">üìã –õ–æ–≥ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó DAO-—Ñ–∞–π–ª—ñ–≤:</div>

  <footer>
    <p>¬© 2025 AgroProsper DAO. –í—Å—ñ –ø—Ä–∞–≤–∞ –∑–∞—Ö–∏—â–µ–Ω–æ.</p>
  </footer>

  <script>
    const hour = new Date().getHours();
    if (hour >= 20 || hour < 6) {
      document.body.classList.add('night');
    }

    function runFullCycle() {
      fetch('/run/full')
        .then(res => res.text())
        .then(msg => {
          document.getElementById('output').innerText = msg;
        })
        .catch(err => {
          document.getElementById('output').innerText = '‚ùå –ü–æ–º–∏–ª–∫–∞: ' + err;
        });
    }
  </script>
</body>
</html>
