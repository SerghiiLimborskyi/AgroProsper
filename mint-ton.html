<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üéñÔ∏è –ú—ñ–Ω—Ç SBT —á–µ—Ä–µ–∑ TON</title>
  <script type="module" src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="mint-container">
    <h1>üéñÔ∏è –û—Ç—Ä–∏–º–∞–π DAO-–±–µ–π–¥–∂</h1>
    <p>–í–∞—à AgroScore: <span id="score">‚Äî</span></p>

    <div id="connect-btn"></div>

    <div id="wallet-section" style="display:none;">
      <p>üîó –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ: <span id="wallet-address"></span></p>
      <button id="mint-btn">üéñÔ∏è –ú—ñ–Ω—Ç–∏–Ω–≥ SBT</button>
    </div>

    <p id="status-msg"></p>
  </div>

  <script type="module">
    import { TonConnectUI } from "https://unpkg.com/@tonconnect/ui@latest";

    const score = new URLSearchParams(window.location.search).get('score') || '0';
    document.getElementById('score').textContent = score;

    const tonConnect = new TonConnectUI({
      manifestUrl: 'https://your-domain.com/tonconnect-manifest.json',
      buttonRootId: 'connect-btn'
    });

    tonConnect.onStatusChange(wallet => {
      if (wallet?.account?.address) {
        document.getElementById('wallet-address').textContent = wallet.account.address;
        document.getElementById('wallet-section').style.display = 'block';
      }
    });

    document.getElementById('mint-btn').onclick = async () => {
      document.getElementById('status-msg').textContent = '‚è≥ –ú—ñ–Ω—Ç–∏–Ω–≥...';

      try {
        const tx = {
          validUntil: Math.floor(Date.now() / 1000) + 60,
          messages: [{
            address: 'EQC...–≤–∞—à_SBT_–∫–æ–Ω—Ç—Ä–∞–∫—Ç',
            amount: '10000000', // 0.01 TON
            payload: 'base64:...'
          }]
        };

        await tonConnect.sendTransaction(tx);
        document.getElementById('status-msg').textContent = '‚úÖ –ó–∞–ø–∏—Ç –Ω–∞ –º—ñ–Ω—Ç –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ!';
      } catch (err) {
        document.getElementById('status-msg').textContent = '‚ùå –ü–æ–º–∏–ª–∫–∞ –º—ñ–Ω—Ç–∏–Ω–≥—É.';
        console.error(err);
      }
    };
  </script>
</body>
</html>
