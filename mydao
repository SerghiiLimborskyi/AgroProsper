bot.command('mydao', async (ctx) => {
  const ref = ctx.from.id;
  const username = ctx.from.username || `ID ${ref}`;
  const link = `https://your-domain.com/referral.html?ref=${ref}`;

  try {
    const response = await fetch(`https://your-domain.com/api/referral-count?ref=${ref}`);
    const data = await response.json();
    const count = data.count || 0;

    let level = 'ğŸŒ± ĞĞ¾Ğ²Ğ°Ñ‡Ğ¾Ğº';
    let badge = 'ğŸŸ¢';
    let badgeImage = null;

    if (count >= 50) {
      level = 'ğŸ† DAO-Ğ›Ñ–Ğ´ĞµÑ€';
      badge = 'ğŸ‘‘';
      badgeImage = 'https://your-domain.com/badges/dao-leader.png';
    } else if (count >= 25) {
      level = 'ğŸ–ï¸ ĞĞ³Ñ€Ğ¾-Ğ†Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€';
      badge = 'ğŸŒŸ';
      badgeImage = 'https://your-domain.com/badges/agro-influencer.png';
    } else if (count >= 10) {
      level = 'ğŸ¥‡ DAO-ĞŸĞ¾ÑĞ¾Ğ»';
      badge = 'ğŸ¥‡';
      badgeImage = 'https://your-domain.com/badges/dao-ambassador.png';
    }

    const message = `ğŸ‘¤ *${username}*\nğŸ“Š ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ñ–Ğ²: *${count}*\nğŸ… Ğ Ñ–Ğ²ĞµĞ½ÑŒ: *${level}* ${badge}`;

    if (badgeImage) {
      await ctx.replyWithPhoto(badgeImage, {
        caption: message,
        parse_mode: 'Markdown',
        reply_markup: {
          inline_keyboard: [[
            { text: 'ğŸ‘ ĞŸĞµÑ€ĞµĞ³Ğ»ÑĞ½ÑƒÑ‚Ğ¸ DAO-Ğ²Ñ–Ğ·Ğ¸Ñ‚ĞºÑƒ', web_app: { url: link } }
          ]]
        }
      });
    } else {
      await ctx.reply(message, {
        parse_mode: 'Markdown',
        reply_markup: {
          inline_keyboard: [[
            { text: 'ğŸ‘ ĞŸĞµÑ€ĞµĞ³Ğ»ÑĞ½ÑƒÑ‚Ğ¸ DAO-Ğ²Ñ–Ğ·Ğ¸Ñ‚ĞºÑƒ', web_app: { url: link } }
          ]]
        }
      });
    }

  } catch (err) {
    console.error('âŒ /mydao error:', err);
    ctx.reply('ğŸš¨ ĞŸĞ¾Ğ¼Ğ¸Ğ»ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¾Ñ‚Ñ€Ğ¸Ğ¼Ğ°Ğ½Ğ½Ñ– Ğ²Ğ°ÑˆĞ¾Ñ— DAO-ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸.');
  }
});
